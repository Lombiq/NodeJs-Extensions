<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Import Project="$(LombiqNpmTargetsPath)/Lombiq.Npm.Targets.targets" Condition="Exists('$(LombiqNpmTargetsPath)/Lombiq.Npm.Targets.targets')" />

  <!-- The messages to search for in the build output are defined in the package.json file. -->
  <Target
    Name="GenerateStylesPipelineErrors"
    AfterTargets="NpmDotnetPrebuild"
    BeforeTargets="Compile">
    <Exec Command="echo Running GenerateStylesPipelineErrors for '$(NodeJsExtensionTarget)' during build of '$(MSBuildProjectName)'" />
    <Warning
      Code="NX01"
      Text="Stylelint error in Node.js Extensions script, check the build output for more information."
      Condition="$(PrebuildOutput.Contains('Error in styles pipeline: stylelint failed'))" />
    <Error
      Code="NX02"
      Text="Compilation error in Node.js Extensions script, check the build output for more information."
      Condition="$(PrebuildOutput.Contains('Error in styles pipeline: compilation failed'))" />
  </Target>

  <!--
        Standard msbuild variables.
    -->
  <Target Name="PrintMSBuildVariables" BeforeTargets="Clean;CoreCompile">
    <Exec Command="dir $(MSBuildProjectDirectory)" ContinueOnError="true" />
    <Message Text="NuGetPackageRoot                     -> '$(NuGetPackageRoot)'                   " Importance="High" />
    <Message Text="LombiqNpmTargetsPath                 -> '$(LombiqNpmTargetsPath)'               " Importance="High" />
    <Message Text="NpmDotnetPrebuildCommand             -> '$(NpmDotnetPrebuildCommand)'           " Importance="High" />
    <Message Text="NpmDotnetPostcleanCommand            -> '$(NpmDotnetPostcleanCommand)'          " Importance="High" />
    <Message Text="NpmTargetsWorkingDirectory           -> '$(NpmTargetsWorkingDirectory)'         " Importance="High" />
    <Message Text="NodeModulesFolderPath                -> '$(NodeModulesFolderPath)'              " Importance="High" />
    <Message Text="NpmCommandsEnvironmentVariables      -> '@(NpmCommandsEnvironmentVariables)'    " Importance="High" />
    <Message Text="NpmDotnetPrebuildWatchedFiles        -> '@(NpmDotnetPrebuildWatchedFiles)'      " Importance="High" />

    <Message Text="MSBuildProjectDirectory              -> '$(MSBuildProjectDirectory)'            " />
    <Message Text="MSBuildProjectDirectoryNoRoot        -> '$(MSBuildProjectDirectoryNoRoot)'      " />
    <Message Text="MSBuildProjectExtension              -> '$(MSBuildProjectExtension)'            " />
    <Message Text="MSBuildProjectFile                   -> '$(MSBuildProjectFile)'                 " />
    <Message Text="MSBuildProjectFullPath               -> '$(MSBuildProjectFullPath)'             " />
    <Message Text="MSBuildProjectName                   -> '$(MSBuildProjectName)'                 " />
    <Message Text="MSBuildRuntimeType                   -> '$(MSBuildRuntimeType)'                 " />
    <Message Text="MSBuildRuntimeVersion                -> '$(MSBuildRuntimeVersion)'              " />
    <Message Text="MSBuildSDKsPath                      -> '$(MSBuildSDKsPath)'                    " />
    <Message Text="MSBuildStartupDirectory              -> '$(MSBuildStartupDirectory)'            " />

    <!-- Gets the current file. -->
    <Message Text="MSBuildThisFile                      -> '$(MSBuildThisFile)'                    " />

    <!-- Gets the current file directory. -->
    <Message Text="MSBuildThisFileDirectory             -> '$(MSBuildThisFileDirectory)'           " />

    <Message Text="MSBuildThisFileDirectoryNoRoot       -> '$(MSBuildThisFileDirectoryNoRoot)'     " />
    <Message Text="MSBuildThisFileExtension             -> '$(MSBuildThisFileExtension)'           " />
    <Message Text="MSBuildThisFileFullPath              -> '$(MSBuildThisFileFullPath)'            " />
    <Message Text="MSBuildThisFileName                  -> '$(MSBuildThisFileName)'                " />
  </Target>
</Project>
